#+TITLE: Procesos estocásticos
#+SUBTITLE:
#+AUTHOR: Ignacio Cordón Castillo
#+OPTIONS: toc:nil
#+LANGUAGE: es
#+STARTUP: indent
#+DATE:

#+latex_header: \usepackage{amsmath} 
#+latex_header: \usepackage{amsthm}
#+latex_header: \usepackage{mathabx}
#+latex_header: \newtheorem*{theorem}{Teorema}
#+latex_header: \newtheorem*{fact}{Proposición}
#+latex_header: \newtheorem*{lemma}{Proposición}
#+latex_header: \newtheorem*{definition}{Definición}
#+latex_header: \setlength{\parindent}{0pt}
#+latex_header: \setlength{\parskip}{1em}
#+latex_header: \usepackage{color}
#+latex_header: \newenvironment{wording}{\setlength{\parskip}{0pt}\rule{\textwidth}{0.5em}}{~\\\rule{\textwidth}{0.5em}}
#+latex_header: \everymath{\displaystyle}

#+attr_latex: :float t :width 4cm
[[../by-nc-sa.png]]

* Resumen
** Notaciones
- Las igualdades entre probabilidades, esperanzas, etc las entendemos como igualdades casi seguramente, dado que la probabilidad es una medida de Lebesgue normalizada.

** Tema 1: Teoría general de procesos estocásticos
*** Repaso teoría de la medida y teoría de probabilidad
**** Espacio medible
Es una tupla $(\Omega, \mathcal{A})$ donde $\mathcal{A}$ es una $\sigma$ álgebra, esto es, es cerrada para uniones numerables y cerrada para complementarios.

De la definición de $\sigma$ álgebra se puede deducir que es cerrada para intersecciones numerables y que el vacío y el total están en ella.

Como caso particular de $\sigma$ álgebra, las finitas se llaman álgebras.

**** Aplicación y función medible.

Dados dos espacios medibles $(\Omega_1, \mathcal{A}_1)$ y $(\Omega_2, \mathcal{A}_2)$, una *aplicación medible* es una aplicación $f: \Omega_1 \rightarrow \Omega_2$ verificando que para todo $A_2 \in \mathcal{A}_2$ se tiene $f^{-1}(A_2) \in \mathcal{A}_1$.

Una *función medible finita* es una aplicación medible que va a una $\sigma$ álgebra de Borel, multidimensional o unidimensional.

#+begin_fact
Una función $f: (\Omega, \mathcal{A}) \rightarrow (\mathbb{R}^n, \mathbb{B}^n)$ es una función medible multidimensional sii $f_i, \forall i=1,\ldots n$ es función medible unidimensional, donde $f=(f_1, \ldots f_n)^T$
#+end_fact

**** $\sigma$ álgebra generada por una clase de conjuntos
Dada $\mathcal{D}$ clase de conjuntos, definimos $\sigma(\mathcal{D})$ como la menor $\sigma$ álgebra que contiene a $\mathcal{D}$

#+begin_fact
Una función $f: (\Omega_1, \mathcal{A}_1) \rightarrow (\Omega_2, \mathcal{A}_2)$ entre espacios medibles es aplicación medible sii $f^{-1}(\mathcal{D}) \subseteq \mathcal{A}_1$ con $\mathcal{D} : \sigma(\mathcal{D}) = \mathcal{A}_2$
#+end_fact

**** $\sigma$ álgebra de Borel

Se define como $\mathbb{B}^n = \sigma(\{ ]-\infty, x], x \in \mathbb{R}^n\})$

#+begin_fact
Dada una función medible $f:(\Omega, \mathcal{A}) \rightarrow (\mathbb{R}^n, \mathbb{B}^n)$ $f$ es medible sii $f^{-1}(]-\infty, x]) = [f\le x] \in \mathcal{A}$ para todo $x\in \mathbb{R}^n$
#+end_fact

Hacemos una aclaración sobre la notación. $]-\infty,x] = ]-\infty, x_1] \times ]-\infty, x_2] \times \ldots \times ]-\infty, x_n]$ donde $x=(x_1, \ldots x_n) \in \mathbb{R}^n$.

$[f\le x] = \{x\in \Omega: f_i(x) \le x_i\}$

**** Medidas
Dado un espacio medible $(\Omega, \mathcal{A})$ una medida es una aplicación $\mu : \mathcal{A} \rightarrow \mathbb{R}$ verificando que es no negativa y es $\sigma$ aditiva.

A la terna $(\Omega, \mathcal{A}, \mu)$ se la llama *espacio de medida*.

***** Axiomas de Kolmogorov
Una medida $\mu$ sobre un espacio medible es probabilidad si además $\sigma(\Omega) = 1$. Los otros dos considerados axiomas de Kolmogorov son la no negatividad y $\sigma$ aditividad, ya incluidas en la definición de medida.

Si $\mu$ es probabilidad, el espacio de medida asociado se denomina *espacio probabilístico*.

**** Variables aleatorias

$X: \mathcal{A} \rightarrow \mathbb{R}$ es una variable aleatoria sii es *función medible finita definida en un espacio probabilístico*. Esto implica que la función va de espacios $(\Omega, \mathcal{A})$ a $(\mathbb{R}, \mathbb{B})$

Si la función llega al espacio $(\mathbb{R}^n, \mathbb{B}^n)$ tenemos un vector aleatorio.

Se notará v.a. indistintamente a variables aleatorias y vectores aleatorios. Se infiere su significado por el contexto.

#+begin_fact
$X=(X_1, \ldots X_n)^T$ es vector aleatorio sii $X_i$ es v.a. para todo $i=1, \ldots n$
#+end_fact

#+begin_definition
*Distribución de probabilidad de una variable aleatoria*

Sea $X$ v.a. sobre $(\Omega, \mathcal{A}, P)$ se define la distribución de la probabilidad de $X$ como $P_X(B) = P[X \in B], \forall B \in \mathbb{B}$.
#+end_definition

A partir de la distribución de probabilidad se define $F_X : \mathbb{R} \rightarrow [0,1]$ como $F_X(x) = P[X \le x]$, *función de distribución*. También podemos definir la *función característica* como $\varphi_X(t) = E[e^{itX}]$.

#+begin_definition
$\sigma$ álgebra a partir de $X$ v.a.

Se define como $\sigma(X):= X^{-1}(\mathbb{B}^n)$
#+end_definition

#+begin_definition
*v.a. discreta, v.a continua*

$X$ va es:

1. *discreta* sii $\exists E_x$ numerable verificando $P[X \in E_x] = 1$
2. *continua* sii $\exists f$ función de densidad tal que $F(x) = \int_{-\infty}^x f(y) dy$
#+end_definition

#+begin_definition
Se definen los momentos de orden $k$:

*Momentos no centrados*: $E[X^k]$
*Momentos centrados*: $E[(X-a)^k]$

En el caso $k=2$, el momento no centrado $\sigma^2 = E[(X-a)^2] = EX^2 - (EX)^2$
#+end_definition


#+begin_definition
*Covarianza*

\[Cov(X,Y) = E[(X-EX)] E[(Y-EY)]\]
#+end_definition


*** Procesos estocásticos
Un proceso estocástico es una familia $\{X_t}_{t\in T}$ de v.a. definidas en un espacio probabilístico $(\Omega, \mathcal{A}, P)$.

$T$ será un conjunto ordenado arbitrario, que se denomina espacio paramétrico (discreto/continuo), donde discreto se entiende como numerable.

En lo que sigue v.a. denotará variable aleatoria unidimensional.

Todos los $X_t$ verifican que van desde el espacio de medida $(\Omega, \mathcal{A}, P)$ hasta el espacio de estados $(E, \mathbb{B}_E)$, con $E \subseteq \mathbb{R}$. Normalmente consideraremos espacio de estados $(\mathbb{R}, \mathbb{B})$

#+begin_definition
*Trayectoria*

Dado un proceso estocástico $\{X_t\}_{t\in T}$ llamamos trayectoria asociada a un $\w \in \Omega$ fijo a la función $X (w)(t) := X_t (w)$ 
#+end_definition

#+begin_definition
*Proceso medible*

Un proceso se dice medible si la función 

\[\left\{\begin{array}{rcl} 
T \times \Omega & \rightarrow & \mathbb{R}\\ 
(t,w) \mapsto X(t,w) \end{array} \right.\]

es medible.
#+end_definition

*** Características de procesos estocásticos

Definimos, suponiendo que las esperanzas tienen siempre sentido:

**** Función media
$\mu : T \rightarrow \mathbb{R}$, con $\mu(t) = E(X_t)$
**** Momentos
$\mu_k : T \rightarrow \mathbb{R}$ con $\mu_k(t) = E[X_t^k]$
**** Función correlación
$R : T\times T \rightarrow \mathbb{R}$ con $R(t,s) = E[X_t X_s]$
**** Función covarianza
$C : T\times T \rightarrow \mathbb{R}$ con $C(t,s) = E[(X_t - \mu(t))(X_s - \mu(s))] = R(s,t) - \mu(t) \mu(s)$

*** Clasificación de los procesos estocásticos
Sea $\{X_t\}_{t\in T}$ proceso estocástico con espacio de estados $(E, \mathbb{B}_E), E\subseteq \mathbb{R}$.

**** En función del espacio paramétrico:
- Si $T$ es discreto, tenemos PE en tiempo discreto
- si $T$ es continuo, tenemos PE en tiempo continuo

**** En función del espacio de estados:
- Si $E$ es discreto, tenemos PE discreto (cadenas)
- Si $E$ es continuo, tenemos PE continuo.


A los PDTC (procesos discretos en tiempo continuo), los llamamos cadenas de Markov.

**** Atendiendo a la relación entre las variables del proceso
***** Incrementos independientes
$X_{t_1}, X_{t_2}-X_{t_1}, \ldots X_{t_n} - X_{t_{n-1}}$ son v.a. independientes.
***** Incrementos estacionarios
$\{X_t\}_{t\in T}$ es un proceso con incrementos estacionarios si $X_t - X_s$ y $X_{t+h}-X_{s+h}$ tienen la misma distribución $\forall h>0$

***** Procesos estrictamente estacionarios (estacionarios en sentido amplio)
Para cualquier $n\in \mathbb{N}$, $\forall t_1, \ldots t_n$, $dist(X_{t_1}, \ldots X_{t_n}) = dist(X_{t_1 + h}, \ldots X_{t_n + h})$ para cualquier $h > 0$

***** Procesos débilmente estacionarios
Un proceso $\{X_t\}_{t\in T}$ es débilmente estacionario si:
- Es de segudno orden, esto es $E[X_t^2] < \infty \forall t$
- Tiene función media constante
- Tiene función de covarianza verificando:
\[C(s,t) := C(0,t-s)\]


#+begin_fact
Todo proceso estrictamente estacionario con momentos de segundo orden es débilmente estacionario.
#+end_fact

**** Martingala
$\{X_n\}_{n\in \mathbb{N}}$ es *martingala* si $\forall n, EX_n < \infty$ y para todo $n\in \mathbb{N}$ se tiene $E[X_{n+1}/X_1, \ldots X_n] = X_n$ casi seguramente.
**** Procesos de Markov
$\{X_n\}_{n\in \mathbb{N}}$ es proceso de Markov sii:

\[\forall n\in \mathbb{N}, \forall B \in \mathbb{B}, P[X_{n+1} \in B/ X_1, \ldots X_n] = P[X_{n+1} \in B/X_n], cs\]

*** Trayectorias y distribución
$\forall w \in \Omega$ fijo definimos $X(w): \mathbb{N} \rightarrow \mathbb{R}$ con $X(w)(n) = X_n(w) \in \mathbb{R}^{\mathbb{N}}$

Por tanto podemos definir:

\[\begin{array}{rccl}
\mathcal{X}: & \Omega & \rightarrow & \mathbb{R}^{\mathbb{N}}\\
& w & \mapsto & \{X_n(w)\}_n
\end{array}\]

Para ver que $\mathcal{X}$ es medible nos hace falta una $\sigma$ álgebra sobre $\mathbb{R}^{\mathbb{N}}$.

**** Sigma álgebra Borel sobre $\mathbb{R}^{\mathbb{N}}$

#+begin_definition
Definimos el rectángulo de lados $B_1, \ldots B_k \in \mathbb{B}$ como:

\[R(B_1, \ldots B_k) = \Big\{ \{x_n\}_{n\in\mathbb{N}} : x_i \in B_i, i=1,\ldots k\Big\}\]

La clase de rectángulos medibles $\mathcal{C}^{\mathbb{N}}$ es semiálgebra (cerrado para el total y el vacío, para intersecciones, y verifica que para $A \in \mathcal{C}^{\mathbb{N}}$ existen $S_1, \ldots S_k$ disjuntos verificándose $\bar{A} = \bigcup_{j=1}^k S_j$.
#+end_definition

#+begin_definition
Definimos $\sigma$ álgebra $\mathbb{B}^{\mathbb{N}} := \sigma(\mathcal{C}^{\mathbb{N}})$
#+end_definition

Usando que $\sigma(\mathcal{C}^{\mathbb{N}})$ es semiálgebra, la $\sigma$ álgebra se forma a partir de uniones finitas de elementos de $\mathcal{C}^{\mathbb{N}}$

***** Teorema de medibilidad - caracterización de PETD
\[\{X_n\}_{n\in \mathbb{N}} \quad PETD \Leftrightarrow 
\begin{array}{rrll} 
\mathcal{X} & : (\Omega, \mathcal{A}, P) & \rightarrow  &(\mathbb{R}^{\mathbb{N}}, \mathbb{B}^{\mathbb{N}})\\
& w & \mapsto & \{X_n(w)\}_{n \in \mathbb{N}}
\end{array} \Leftrightarrow \mathcal{X}^{-1}(C), \forall C\in \mathcal{C}^{\mathbb{N}}\]

***** Distribución de $\{X_n\}_{n\in \mathbb{N}}$ PETD
Dado $\{X_n\}_{n\in \mathbb{N}}$ PETD definimos la medida de probabilidad:

\[P_{\mathcal{X}}: \mathbb{B}^{\mathbb{N}} \rightarrow [0,1], \quad P_{\mathcal{X}}(B) = P(\mathcal{X}^{-1}(B))\]
** Tema 3: Procesos de Markov
Suponemos en lo que sigue un espacio de medida $(\Omega, \mathcal{A}, P)$, un espacio paramétrico $T= \mathbb{N} \cup \{0\}$, $(E,\mathcal{B}_E)$ espacio paramétrico con $E\subseteq \mathbb{R}$ y $\{X_n\}_{n\ge 0}$ PETD.

#+begin_definition
*Filtración de $\sigma$ álgebras*

Se define una filtración de $\sigma$ álgebras como $\{\mathcal{F}_n}_{n\ge 0}$  donde $\mathcal{F}_n$ es $\sigma$ álgebra para $n \in \mathbb{N}$ arbitrario y $\mathcal{F}_n \subseteq \mathcal{F}_{n+1}$.
#+end_definition

A la filtración dada por $\mathcal{F}_n = \sigma(X_0, \ldots X_n)$ se le llama *filtración natural asociada al proceso $\{X_n\}$*

*** Procesos de Markov respecto de una filtración de $\sigma$ álgebras
#+begin_definition
$\{X_n\}$ es proceso de Markov respecto de la filtración $\{\mathcal{F}_n\}$ sii:

1. El proceso está adaptado a la $\sigma$ álgebra: $X_n^{-1} (\mathcal{B}_E) \subseteq \mathcal{F}_n$. Esto implica $\sigma(X_1, \ldots X_n) \subseteq \mathcal{F}_n$
2. $\forall B\in \mathcal{B}_E$, $\forall n \ge 1$ se tiene $P[X_n \in B / \mathcal{F}_{n-1}] = P[X_n \in B/X_{n-1}]$
#+end_definition


#+begin_fact
La segunda condición de la anterior definición equivale a decir que para toda $f: (E, \mathcal{B}_E) \longrightarrow (\mathbb{R}, \mathcal{B})$ medible y acotada, $\forall n \ge 1$ se verifica:

\[E[f(X_n) / \mathcal{F}_{n-1}] = E[f(X_n) / X_{n-1}]\]
#+end_fact

* Ejercicios
